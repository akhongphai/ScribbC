<style>
h1{
    position:relative;
    left:20%;
}
  .rect{
    position:relative;
    left:20%;
    width:60%;
    height:10px;
    border:1px solid black;
    padding:1px;
  }
  .button{
    position:relative;
    left:20%;
  }
</style>
<br>
<br>
<h1 id='h1'>Redirecting in 10s...</h1>
<div class='rect'><div id='filledBox' style='height:100%;background-color:gray;width:100%'></div></div>
<input id='button' class='button' type='button' value='Stop' onclick='return stopRedirect()'/>
<div id='manualRedirect' style='display:none'>If you are not automatically redirected click <a href='https://script.google.com/macros/s/AKfycbwfPL5JL2hq2IIf80eIre1j5As6t20-Z4aAMS_6kAJhC5qtz1g/exec' target='_self'>here.</a></div>
<script>

    var doRedirect=true;
    var width=100;
    setInterval(function(){timer();},1000);

  
  function timer(){
    if(doRedirect){
      width-=10;
      if(width==0){
        var style='height:100%;background-color:gray;width:'+width+'%';
        document.getElementById('filledBox').setAttribute('style',style);
        document.getElementById('h1').innerHTML='Redirecting in '+width/10+'s...';
        window.location.assign('https://script.google.com/macros/s/AKfycbwfPL5JL2hq2IIf80eIre1j5As6t20-Z4aAMS_6kAJhC5qtz1g/exec');
      }else if(width>0){
        var style='height:100%;background-color:gray;width:'+width+'%';
        document.getElementById('filledBox').setAttribute('style',style);
        document.getElementById('h1').innerHTML='Redirecting in '+width/10+'s...';
      }else{
        var style='display:block;position:relative;left:20%';
        document.getElementById('manualRedirect').setAttribute('style',style);
      }
    }
  }
  function stopRedirect(){
    if (doRedirect){
     doRedirect=false;
     document.getElementById('button').value='Continue';
    }else{
     doRedirect=true;
     document.getElementById('button').value='Stop';
    }
  }
  
</script>
